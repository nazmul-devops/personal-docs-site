<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker Swarm | Learn With Nazmul</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="nazmul-rnd-docs">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/nazmul/assets/css/0.styles.570d9d92.css" as="style"><link rel="preload" href="/nazmul/assets/js/app.7f2fd9e5.js" as="script"><link rel="preload" href="/nazmul/assets/js/2.8e9339b6.js" as="script"><link rel="preload" href="/nazmul/assets/js/4.f3598ea0.js" as="script"><link rel="prefetch" href="/nazmul/assets/js/10.a1dfba99.js"><link rel="prefetch" href="/nazmul/assets/js/11.1452f9ea.js"><link rel="prefetch" href="/nazmul/assets/js/12.13a678a6.js"><link rel="prefetch" href="/nazmul/assets/js/13.68da0424.js"><link rel="prefetch" href="/nazmul/assets/js/14.56a4e07c.js"><link rel="prefetch" href="/nazmul/assets/js/15.72ad2885.js"><link rel="prefetch" href="/nazmul/assets/js/16.57b79e0e.js"><link rel="prefetch" href="/nazmul/assets/js/17.17931a8a.js"><link rel="prefetch" href="/nazmul/assets/js/18.0c9df6cc.js"><link rel="prefetch" href="/nazmul/assets/js/19.40c1ea8d.js"><link rel="prefetch" href="/nazmul/assets/js/20.58ac21bb.js"><link rel="prefetch" href="/nazmul/assets/js/21.6c1673c7.js"><link rel="prefetch" href="/nazmul/assets/js/22.f867a3b4.js"><link rel="prefetch" href="/nazmul/assets/js/23.cf6b4557.js"><link rel="prefetch" href="/nazmul/assets/js/24.d7fa8253.js"><link rel="prefetch" href="/nazmul/assets/js/25.43d5035b.js"><link rel="prefetch" href="/nazmul/assets/js/26.61149d3c.js"><link rel="prefetch" href="/nazmul/assets/js/27.b5450c88.js"><link rel="prefetch" href="/nazmul/assets/js/28.1bbe98ef.js"><link rel="prefetch" href="/nazmul/assets/js/29.a8c17ba6.js"><link rel="prefetch" href="/nazmul/assets/js/3.4cbe583d.js"><link rel="prefetch" href="/nazmul/assets/js/30.f624485d.js"><link rel="prefetch" href="/nazmul/assets/js/31.df550944.js"><link rel="prefetch" href="/nazmul/assets/js/32.62faa4c3.js"><link rel="prefetch" href="/nazmul/assets/js/33.91db2892.js"><link rel="prefetch" href="/nazmul/assets/js/34.7df65e7d.js"><link rel="prefetch" href="/nazmul/assets/js/35.5c610647.js"><link rel="prefetch" href="/nazmul/assets/js/36.3d5c2008.js"><link rel="prefetch" href="/nazmul/assets/js/37.2c68e454.js"><link rel="prefetch" href="/nazmul/assets/js/38.e49b9602.js"><link rel="prefetch" href="/nazmul/assets/js/5.b29c500b.js"><link rel="prefetch" href="/nazmul/assets/js/6.b2501f68.js"><link rel="prefetch" href="/nazmul/assets/js/7.d755de4d.js"><link rel="prefetch" href="/nazmul/assets/js/8.e048dc2a.js"><link rel="prefetch" href="/nazmul/assets/js/9.ac99db99.js">
    <link rel="stylesheet" href="/nazmul/assets/css/0.styles.570d9d92.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/nazmul/" class="home-link router-link-active"><!----> <span class="site-name">Learn With Nazmul</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/nazmul/docs/" class="nav-link router-link-active">
  Docs
</a></div><div class="nav-item"><a href="/nazmul/tutorial/" class="nav-link">
  Tutorial
</a></div><div class="nav-item"><a href="https://kachamaal.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  business
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/nazmul/docs/" class="nav-link router-link-active">
  Docs
</a></div><div class="nav-item"><a href="/nazmul/tutorial/" class="nav-link">
  Tutorial
</a></div><div class="nav-item"><a href="https://kachamaal.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  business
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Docker Swarm</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/nazmul/docs/docker-swarm/#what-is-docker-swarm" class="sidebar-link">What is Docker Swarm?</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/nazmul/docs/docker-swarm/#why-we-use-docker-swarm" class="sidebar-link">Why we use Docker Swarm?</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/nazmul/docs/docker-swarm/#docker-swarm-lab-setup-on-server-to-deploy-the-application" class="sidebar-link">Docker Swarm Lab Setup on server to deploy the application</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nazmul/docs/docker-swarm/#step-1-configure-the-cluster-hosts-file" class="sidebar-link">Step 1) Configure the Cluster hosts file</a></li><li class="sidebar-sub-header"><a href="/nazmul/docs/docker-swarm/#step-2-install-docker-ce-on-all-the-nodes" class="sidebar-link">Step 2) Install Docker CE on all the nodes</a></li><li class="sidebar-sub-header"><a href="/nazmul/docs/docker-swarm/#step-3-verify-docker-is-running-on-all-the-nodes" class="sidebar-link">Step 3) Verify Docker is running on all the nodes</a></li><li class="sidebar-sub-header"><a href="/nazmul/docs/docker-swarm/#step-4-create-docker-swarm-cluster" class="sidebar-link">Step 4) Create Docker Swarm Cluster</a></li><li class="sidebar-sub-header"><a href="/nazmul/docs/docker-swarm/#step-5-test-docker-swarm-installation" class="sidebar-link">Step 5) Test Docker Swarm Installation</a></li><li class="sidebar-sub-header"><a href="/nazmul/docs/docker-swarm/#step-6-create-replicas-of-the-service" class="sidebar-link">Step 6) Create replicas of the service</a></li><li class="sidebar-sub-header"><a href="/nazmul/docs/docker-swarm/#step-7-docker-swarm-visualizer" class="sidebar-link">Step 7) Docker Swarm Visualizer</a></li><li class="sidebar-sub-header"><a href="/nazmul/docs/docker-swarm/#postgresql-and-pgadmin-4-install" class="sidebar-link">Postgresql and pgadmin 4 Install</a></li><li class="sidebar-sub-header"><a href="/nazmul/docs/docker-swarm/#extra-configuration-files-for-our-app" class="sidebar-link">Extra Configuration files for our app</a></li><li class="sidebar-sub-header"><a href="/nazmul/docs/docker-swarm/#rolling-update" class="sidebar-link">Rolling Update</a></li><li class="sidebar-sub-header"><a href="/nazmul/docs/docker-swarm/#horizontal-scaling-vs-vertical-scaling-in-docker-container" class="sidebar-link">Horizontal scaling vs Vertical scaling  In Docker Container</a></li><li class="sidebar-sub-header"><a href="/nazmul/docs/docker-swarm/#zero-downtime-service-upgrade" class="sidebar-link">Zero Downtime Service Upgrade</a></li><li class="sidebar-sub-header"><a href="/nazmul/docs/docker-swarm/#secrets" class="sidebar-link">Secrets</a></li><li class="sidebar-sub-header"><a href="/nazmul/docs/docker-swarm/#docker-secrets-postgresql-service" class="sidebar-link">Docker Secrets â€“ PostgreSQL Service</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="docker-swarm"><a href="#docker-swarm" class="header-anchor">#</a> Docker Swarm</h1> <p>by Kallol Biswas &amp; Nazmul Islam (Swapan) - DevOps Engineer at InNeed Cloud</p> <h2 id="what-is-docker-swarm"><a href="#what-is-docker-swarm" class="header-anchor">#</a> What is Docker Swarm?</h2> <blockquote><p>Docker Swarm is a native clustering solution for Docker that turns a group of Docker engines into a single virtual Docker engine. Docker Swarm provides native orchestration features, such as native service discovery, load balancing, scaling, and rolling updates, to manage the deployment and scaling of containerized applications.</p></blockquote> <h2 id="why-we-use-docker-swarm"><a href="#why-we-use-docker-swarm" class="header-anchor">#</a> Why we use Docker Swarm?</h2> <blockquote><p>The primary reason to use Docker Swarm is to manage and orchestrate a large number of Docker containers, which can become complex and difficult to manage as the number of containers grows. With Docker Swarm, you can easily deploy and manage containers across a large number of hosts, automatically distribute load across multiple containers, and easily scale up or down as needed. This makes it easier to build, test, and deploy containerized applications in production environments, where reliability and scalability are critical. Additionally, Docker Swarm provides an easy-to-use, native interface for managing containers, which simplifies the deployment and management of complex, multi-container applications.</p></blockquote> <h2 id="docker-swarm-lab-setup-on-server-to-deploy-the-application"><a href="#docker-swarm-lab-setup-on-server-to-deploy-the-application" class="header-anchor">#</a> Docker Swarm Lab Setup on server to deploy the application</h2> <blockquote><p>To demonstrate how Docker Swarm works, we have a simple cluster that comprises a Swarm Manager node and two worker nodes as shown. The Manager nodes handle all the cluster management tasks while the worker nodes will run the containers.</p></blockquote> <ul><li>docker-manager                   docker-manager-servcer-ip</li> <li>worker-node-1                    worker-node-1-ip</li> <li>worker-node-2                    worker-node-2-ip</li></ul> <h3 id="step-1-configure-the-cluster-hosts-file"><a href="#step-1-configure-the-cluster-hosts-file" class="header-anchor">#</a> Step 1) Configure the Cluster hosts file</h3> <p>To start off, log into each of the nodes and update the /etc/hosts file with the following entries:</p> <div class="language- extra-class"><pre class="language-text"><code>swarm-manager          docker-manager-servcer-ip
worker-node-1          worker-node-1-ip
worker-node-2          worker-node-2-ip
</code></pre></div><p>Next, ensure that all the nodes can ping each other. Therefore, on the manager node, run the commands:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">ping</span> <span class="token parameter variable">-c</span> <span class="token number">4</span> worker-node-1-ip
<span class="token function">ping</span> <span class="token parameter variable">-c</span> <span class="token number">4</span> worker-node-2-ip
</code></pre></div><p>On worker Node 1</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">ping</span> <span class="token parameter variable">-c</span> <span class="token number">4</span> docker-manager-servcer-ip
<span class="token function">ping</span> <span class="token parameter variable">-c</span> <span class="token number">4</span> worker-node-2-ip
</code></pre></div><p>On worker Node 2</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">ping</span> <span class="token parameter variable">-c</span> <span class="token number">4</span> swarm-manager-servcer-ip
<span class="token function">ping</span> <span class="token parameter variable">-c</span> <span class="token number">4</span> worker-node-1-ip
</code></pre></div><h3 id="step-2-install-docker-ce-on-all-the-nodes"><a href="#step-2-install-docker-ce-on-all-the-nodes" class="header-anchor">#</a> Step 2) Install Docker CE on all the nodes</h3> <p>The next step is to install Docker on all the nodes. We are going to install Docker Community Edition (Docker CE) which is free to install and use.</p> <p>Therefore, log into each of the nodes and update the local package index.</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">ssh</span> <span class="token parameter variable">-i</span> <span class="token string">&quot;your-pem-key.pem&quot;</span> ubuntu@swarm-manager-server-ip

<span class="token function">sudo</span> <span class="token function">apt</span> update
</code></pre></div><p>Next, install the prerequisites package needed during the installation</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> apt-transport-https ca-certificates <span class="token function">curl</span> software-properties-common <span class="token parameter variable">-y</span>
</code></pre></div><p>Once all the packages have been installed, add the Docker GPG key</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> https://download.docker.com/linux/ubuntu/gpg <span class="token operator">|</span> <span class="token function">sudo</span> gpg <span class="token parameter variable">--dearmour</span> <span class="token parameter variable">-o</span> /etc/apt/trusted.gpg.d/docker.gpg
</code></pre></div><p>In the next step, add the official Docker repository to your Ubuntu 22.04 system</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> add-apt-repository <span class="token string">&quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu <span class="token variable"><span class="token variable">$(</span>lsb_release <span class="token parameter variable">-cs</span><span class="token variable">)</span></span> stable&quot;</span>
</code></pre></div><p>Next, update the local package index to make the system, aware of the newly added repository.</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">apt</span> update
</code></pre></div><p>Then install Docker from the official Docker repository,</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> docker-ce <span class="token parameter variable">-y</span>
</code></pre></div><p>The command installs Docker alongside additional packages that will be required by Docker to function as expected.</p> <h3 id="step-3-verify-docker-is-running-on-all-the-nodes"><a href="#step-3-verify-docker-is-running-on-all-the-nodes" class="header-anchor">#</a> Step 3) Verify Docker is running on all the nodes</h3> <p>Once installed, the Docker daemon starts automatically. You can verify that the service is running by running the command:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> systemctl status <span class="token function">docker</span>
</code></pre></div><p><img src="/nazmul/assets/img/Docker-Service-Status-Ubuntu-22-04.673e4b9c.jpg" alt="docker-service-status">
Additionally, be sure to enable the Docker service so that it starts automatically on boot time.</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> <span class="token function">docker</span>
</code></pre></div><h3 id="step-4-create-docker-swarm-cluster"><a href="#step-4-create-docker-swarm-cluster" class="header-anchor">#</a> Step 4) Create Docker Swarm Cluster</h3> <p>The next step is to initialize the Docker Swarm on the Manager node. Once initialized, we will then add the worker nodes to the cluster.</p> <p>To create a Docker Swarm Cluster, run the command:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">docker</span> swarm init --advertise-addr swarm-manager-servcer-ip
</code></pre></div><p><img src="/nazmul/assets/img/Docker-Swarm-Init-Ubuntu-22-04.33c3654c.jpg" alt="docker-swarm-init"></p> <p>Once Docker Swarm has been initialized, a command for joining the worker nodes to the cluster will be displayed on the terminal. Copy the command as you will need to run it on each of the worker nodes as previously mentioned.</p> <p>Next, login back to each of the worker nodes and paste the command in order to join the cluster.</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">docker</span> swarm <span class="token function">join</span> <span class="token parameter variable">--token</span> SWMTKN-1-1k397e5o52cae0yipopqcu9werjcwuss1exbyj4635rrjjl723-7ocx56uhb7p1ri7h2u6ynxyno worker-node-1-ip
</code></pre></div><p>If all goes well, you should get the following output</p> <p>Output</p> <p>This node joined a swarm as a worker</p> <p><img src="data:image/jpeg;base64,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" alt="docker-swarm-join-worker"></p> <p>Next, confirm that all the nodes have joined the cluster as follows.</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">docker</span> <span class="token function">node</span> <span class="token function">ls</span>
</code></pre></div><p>You should get the following output displaying all the nodes in the cluster.</p> <p><img src="/nazmul/assets/img/List-Nodes-in-docker-Swarm-Ubuntu.5539253f.jpg" alt="node-list-in-docker-swarm-manager"></p> <h3 id="step-5-test-docker-swarm-installation"><a href="#step-5-test-docker-swarm-installation" class="header-anchor">#</a> Step 5) Test Docker Swarm Installation</h3> <p>To test docker swarm installation, head over to the manager node and deploy a container application to the cluster. In this example, we are deploying an Nginx web server container and mapping it to port 80 on the host.</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">docker</span> <span class="token function">service</span> create <span class="token parameter variable">--name</span> trmis-webapp <span class="token parameter variable">--publish</span> <span class="token number">80</span>:80 kallolinneed/frontend_webapp:v2
</code></pre></div><p><img src="/nazmul/assets/img/Nginx-Based-Service-docker-swarm.823aab91.jpg" alt="nginx-based-service"></p> <p>Next, verify the status of the application service deployed.</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">docker</span> <span class="token function">service</span> <span class="token function">ls</span>
</code></pre></div><p><img src="/nazmul/assets/img/List-Service-in-Docker-Swarm.d6528cbd.jpg" alt="service-list"></p> <h3 id="step-6-create-replicas-of-the-service"><a href="#step-6-create-replicas-of-the-service" class="header-anchor">#</a> Step 6) Create replicas of the service</h3> <p>Finally, create ten replicas of the service and scale them across both the Docker manager and the worker nodes.</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">docker</span> <span class="token function">service</span> scale trmis-webapp<span class="token operator">=</span><span class="token number">10</span>
</code></pre></div><p><img src="/nazmul/assets/img/Service-Scale-docker-Swarm.2cda532a.jpg" alt="service-scale"></p> <p>Next, confirm the status of the replicas. This time around, you will notice that we have 3 replicas.</p> <p><img src="/nazmul/assets/img/Verify-Service-inDocker-Swarm.98697872.jpg" alt="service-verify"></p> <p>At this point, Nginx web server container should be running across all the nodes in the cluster on port 80. To confirm this, head over to your browser, and access the web server from all the nodes.</p> <ul><li><p>http://docker-manager.com or http://192.168.10.135</p></li> <li><p>http://worker-node-1-ip</p></li> <li><p>http://worker-node-2-ip</p></li></ul> <h3 id="step-7-docker-swarm-visualizer"><a href="#step-7-docker-swarm-visualizer" class="header-anchor">#</a> Step 7) Docker Swarm Visualizer</h3> <p>Demo container that displays Docker services running on a Docker Swarm in a diagram.</p> <p>This works only with Docker swarm mode which was introduced in Docker 1.12. These instructions presume you are running on the master node and you already have a Swarm running.</p> <p>Each node in the swarm will show all tasks running on it. When a service goes down it'll be removed. When a node goes down it won't, instead the circle at the top will turn red to indicate it went down. Tasks will be removed. Occasionally the Remote API will return incomplete data, for instance the node can be missing a name. The next time info for that node is pulled, the name will update.</p> <div class="language-sh extra-class"><pre class="language-sh"><code>  <span class="token function">sudo</span> <span class="token function">docker</span> <span class="token function">service</span> create <span class="token punctuation">\</span>
  <span class="token parameter variable">--name</span><span class="token operator">=</span>viz <span class="token punctuation">\</span>
  <span class="token parameter variable">--publish</span><span class="token operator">=</span><span class="token number">8080</span>:8080/tcp <span class="token punctuation">\</span>
  <span class="token parameter variable">--constraint</span><span class="token operator">=</span>node.role<span class="token operator">==</span>manager <span class="token punctuation">\</span>
  <span class="token parameter variable">--mount</span><span class="token operator">=</span>type<span class="token operator">=</span>bind,src<span class="token operator">=</span>/var/run/docker.sock,dst<span class="token operator">=</span>/var/run/docker.sock <span class="token punctuation">\</span>
  dockersamples/visualizer

</code></pre></div><blockquote><p>To varify docker swarm visualization hit docker-swarm-manager-node-ip:8080</p></blockquote> <p><img src="/nazmul/assets/img/swarm-viz.b89b6bd4.png" alt="docker-swarm-visualization"></p> <h3 id="postgresql-and-pgadmin-4-install"><a href="#postgresql-and-pgadmin-4-install" class="header-anchor">#</a> Postgresql and pgadmin 4 Install</h3> <div class="language-sh extra-class"><pre class="language-sh"><code>Root
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
<span class="token function">apt</span> update
<span class="token function">apt</span> <span class="token function">install</span> postgresql postgresql-contrib
systemctl start postgresql.service
systemctl status postgresql.service
systemctl <span class="token builtin class-name">enable</span> postgresql.service
<span class="token function">sudo</span> <span class="token parameter variable">-i</span> <span class="token parameter variable">-u</span> postgres
psql
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
create user inneed with password â€˜Inneed@cloudâ€™<span class="token punctuation">;</span>
create database inneeddb<span class="token punctuation">;</span>
grant all privileges on database inneeddb to inneed<span class="token punctuation">;</span>
<span class="token builtin class-name">exit</span><span class="token punctuation">;</span>



$ <span class="token function">curl</span> https://www.pgadmin.org/static/packages_pgadmin_org.pub <span class="token operator">|</span> <span class="token function">sudo</span> apt-key <span class="token function">add</span>
$ <span class="token function">sudo</span> <span class="token function">sh</span> <span class="token parameter variable">-c</span> <span class="token string">'echo &quot;deb https://ftp.postgresql.org/pub/pgadmin/pgadmin4/apt/$(lsb_release -cs) pgadmin4 main&quot; &gt; /etc/apt/sources.list.d/pgadmin4.list &amp;&amp; apt update'</span>

<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> pgadmin4

</code></pre></div><h3 id="extra-configuration-files-for-our-app"><a href="#extra-configuration-files-for-our-app" class="header-anchor">#</a> Extra Configuration files for our app</h3> <p>This is an nginx.conf file</p> <div class="language-conf extra-class"><pre class="language-text"><code># auto detects a good number of processes to run
worker_processes auto;

#Provides the configuration file context in which the directives that affect connection processing are specified.
events {
    # Sets the maximum number of simultaneous connections that can be opened by a worker process.
    worker_connections 8000;
    # Tells the worker to accept multiple connections at a time
    multi_accept on;
}


http {
    # what times to include
    include       /etc/nginx/mime.types;
    # what is the default one
    default_type  application/octet-stream;

    # Sets the path, format, and configuration for a buffered log write
    log_format compression '$remote_addr - $remote_user [$time_local] '
        '&quot;$request&quot; $status $upstream_addr '
        '&quot;$http_referer&quot; &quot;$http_user_agent&quot;';

    server {
        # listen on port 80
        listen 80;
        # save logs here
        access_log /var/log/nginx/access.log compression;

        # where the root here
        root /usr/share/nginx/html;
        # what file to server as index
        index index.html index.htm;

        location / {
            # First attempt to serve request as file, then
            # as directory, then fall back to redirecting to index.html
            try_files $uri $uri/ /index.html;
        }

        # Media: images, icons, video, audio, HTC
        location ~* \.(?:jpg|jpeg|gif|png|ico|cur|gz|svg|svgz|mp4|ogg|ogv|webm|htc)$ {
          expires 1M;
          access_log off;
          add_header Cache-Control &quot;public&quot;;
        }

        # Javascript and CSS files
        location ~* \.(?:css|js)$ {
            try_files $uri =404;
            expires 1y;
            access_log off;
            add_header Cache-Control &quot;public&quot;;
        }

        # Any route containing a file extension (e.g. /devicesfile.js)
        location ~ ^.+\..+$ {
            try_files $uri =404;
        }
    }
}
</code></pre></div><p>This is a Dockerfile for builing a custom image for our application</p> <div class="language-Dockerfile extra-class"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">FROM</span> node:lts-alpine3.16 <span class="token keyword">as</span> build</span>

<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>

<span class="token instruction"><span class="token keyword">RUN</span> npm i -g pnpm</span>

<span class="token instruction"><span class="token keyword">COPY</span> package.json ./</span>
<span class="token instruction"><span class="token keyword">COPY</span> pnpm-lock.yaml ./</span>
<span class="token instruction"><span class="token keyword">RUN</span> pnpm i</span>
<span class="token instruction"><span class="token keyword">COPY</span> . ./</span>
<span class="token instruction"><span class="token keyword">RUN</span> pnpm build</span>

<span class="token instruction"><span class="token keyword">FROM</span> nginx:1.23-alpine</span>
<span class="token instruction"><span class="token keyword">COPY</span> nginx.conf /etc/nginx/nginx.conf</span>

<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">build</span></span> /app/build /usr/share/nginx/html</span>
<span class="token instruction"><span class="token keyword">EXPOSE</span> 80</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;nginx&quot;</span>, <span class="token string">&quot;-g&quot;</span>, <span class="token string">&quot;daemon off;&quot;</span>]</span>

</code></pre></div><h3 id="rolling-update"><a href="#rolling-update" class="header-anchor">#</a> Rolling Update</h3> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">docker</span> <span class="token function">service</span> create â€“name redis â€“replicas <span class="token number">3</span> redis:3.0.7

<span class="token function">sudo</span> <span class="token function">docker</span> <span class="token function">ps</span>

<span class="token function">sudo</span> <span class="token function">docker</span> <span class="token function">service</span> update â€“ image redis:3.0.8 redis
</code></pre></div><p>Draining Nodes</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">docker</span> <span class="token function">node</span> update â€“availability drain worker1
</code></pre></div><p>Drain status prevents the nodes for receiving new tasks</p> <h3 id="horizontal-scaling-vs-vertical-scaling-in-docker-container"><a href="#horizontal-scaling-vs-vertical-scaling-in-docker-container" class="header-anchor">#</a> Horizontal scaling vs Vertical scaling  In Docker Container</h3> <ul><li>Horizontal scaling :  When we are talking about increase the number of replicas ( we are increase the number of container )</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">docker</span> <span class="token function">service</span> scale <span class="token punctuation">[</span> <span class="token function">service</span> name <span class="token punctuation">]</span> <span class="token operator">=</span><span class="token number">10</span>
<span class="token function">sudo</span> <span class="token function">docker</span> <span class="token function">service</span> scale my_service-<span class="token operator">=</span><span class="token number">10</span>
</code></pre></div><ul><li>Vertical scaling: When we are talking about upgrading the service vertically it means we actually upgrading the resource in current service . We are increasing the number of CPUs on the server we are increasing RAM on the server we are increasing hard drive on the server .</li></ul> <h3 id="zero-downtime-service-upgrade"><a href="#zero-downtime-service-upgrade" class="header-anchor">#</a> Zero Downtime Service Upgrade</h3> <div class="language-sh extra-class"><pre class="language-sh"><code>Sudo <span class="token function">docker</span> <span class="token function">service</span> update â€“image <span class="token punctuation">[</span>image name<span class="token punctuation">]</span> <span class="token punctuation">[</span>version<span class="token punctuation">]</span> <span class="token punctuation">[</span>service name<span class="token punctuation">]</span>
<span class="token function">sudo</span> <span class="token function">docker</span> <span class="token function">service</span> update â€“image nginx:1:15<span class="token punctuation">;</span><span class="token number">12</span> web_server
<span class="token function">sudo</span> <span class="token function">docker</span> <span class="token function">service</span> <span class="token function">ps</span> web_server
</code></pre></div><ul><li>Update Container for change container Port 8080 to 9090
sudo docker service update â€“publish-rm 8080 â€“publish-add 9090:80 web_server</li></ul> <h3 id="secrets"><a href="#secrets" class="header-anchor">#</a> Secrets</h3> <ul><li>Create Docker Service with Secrets</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">mkdir</span> Secretsexample
<span class="token builtin class-name">cd</span> Secretsexample
<span class="token function">nano</span> dbpass.txt
<span class="token function">sudo</span> <span class="token function">docker</span> secret create db_password dbpass.txt
<span class="token function">sudo</span> <span class="token function">docker</span> secret <span class="token function">ls</span>
<span class="token function">sudo</span> <span class="token function">docker</span> secret inspect <span class="token punctuation">[</span> secret name<span class="token punctuation">]</span>
</code></pre></div><h3 id="docker-secrets-postgresql-service"><a href="#docker-secrets-postgresql-service" class="header-anchor">#</a> Docker Secrets â€“ PostgreSQL Service</h3> <p>Docker Secret for User_name  =  trmis_user
Docker Secret for Password     =  trmis_pass</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">docker</span> <span class="token function">service</span> create <span class="token punctuation">\</span>
<span class="token parameter variable">--name</span> trmisdb <span class="token punctuation">\</span>
<span class="token parameter variable">--replicas</span> <span class="token number">2</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--constraint</span><span class="token operator">=</span>node.role<span class="token operator">=</span>manager <span class="token punctuation">\</span>
<span class="token parameter variable">--network</span> trmisntw <span class="token punctuation">\</span>
<span class="token parameter variable">--secret</span> trmis_pass <span class="token punctuation">\</span>
<span class="token parameter variable">--secret</span> trmis_user <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">POSTGRES_PASSWORD_FILE</span><span class="token operator">=</span>/run/secrets/trmis_pass <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">POSTGRES_USER_FILE</span><span class="token operator">=</span>/run/secrets/trmis_user <span class="token punctuation">\</span>
postgres:latest
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/nazmul/assets/js/app.7f2fd9e5.js" defer></script><script src="/nazmul/assets/js/2.8e9339b6.js" defer></script><script src="/nazmul/assets/js/4.f3598ea0.js" defer></script>
  </body>
</html>
