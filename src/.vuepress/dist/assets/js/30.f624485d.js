(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{338:function(e,t,a){"use strict";a.r(t);var s=a(10),n=Object(s.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"kubernetes-tutorial"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kubernetes-tutorial"}},[e._v("#")]),e._v(" Kubernetes Tutorial")]),e._v(" "),t("p",[t("strong",[t("em",[e._v("By: Nazmul Islam - Junior DevOps Engineer")])])]),e._v(" "),t("p",[t("strong",[e._v("Ref Usefull Links:")])]),e._v(" "),t("ol",[t("li",[t("p",[t("a",{attrs:{href:"https://youtu.be/Zxozz8P_l5M",target:"_blank",rel:"noopener noreferrer"}},[e._v("YouTube Video - Kubernetes Multi Master Setup with LoadBalancer on Ubuntu"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://youtu.be/uGePZ4Zp34A",target:"_blank",rel:"noopener noreferrer"}},[e._v("YouTube - Configure HA Cluster using KeepAlived with FloatingIP | Install KeepAlived on Ubuntu"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://youtu.be/KV3C-GQzkpc",target:"_blank",rel:"noopener noreferrer"}},[e._v("YouTube - Kubernetes - Setup High Availability Multi-Master Cluster"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.learnitguide.net/2021/10/kubernetes-multi-master-setup-with.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Document Link of 1 No YouTube Video"),t("OutboundLink")],1)])])]),e._v(" "),t("h2",{attrs:{id:"what-is-kubernetes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#what-is-kubernetes"}},[e._v("#")]),e._v(" What is Kubernetes?")]),e._v(" "),t("p",[e._v('Kubernetes (often abbreviated as "K8s") is an open-source system for automating the deployment, scaling, and\nmanagement of containerized applications. It provides a way to manage multiple containers as a single unit, making it easier to deploy, scale, and manage applications in a microservices architecture.')]),e._v(" "),t("p",[e._v("Kubernetes was originally developed by Google, and is now maintained by the Cloud Native Computing Foundation (CNCF). It is widely adopted and has become the de facto standard for managing containerized applications in production.")]),e._v(" "),t("h2",{attrs:{id:"why-we-should-use-kubernetes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#why-we-should-use-kubernetes"}},[e._v("#")]),e._v(" Why we should use Kubernetes?")]),e._v(" "),t("p",[e._v("There are several reasons why organizations choose to use Kubernetes:")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("High Availability: We can deploy any changes to kubernetes with no downtime.")])]),e._v(" "),t("li",[t("p",[e._v("Scalability: Kubernetes makes it easy to horizontally scale applications by adding or removing replicas of a container as needed.")])]),e._v(" "),t("li",[t("p",[e._v("Resilience: Kubernetes can automatically recover from failures by replacing failed containers and ensuring that the desired number of replicas is maintained.")])]),e._v(" "),t("li",[t("p",[e._v("Load balancing: Kubernetes can automatically distribute incoming traffic across multiple replicas of a container to ensure that no single replica becomes a bottleneck.")])]),e._v(" "),t("li",[t("p",[e._v("Portability: Kubernetes allows applications to run on different cloud platforms, as well as on-premises, making it easier to deploy applications in different environments.")])]),e._v(" "),t("li",[t("p",[e._v("Ease of deployment: Kubernetes provides a unified way to define, deploy, and manage applications, making it easier to roll out updates and rollbacks.")])])]),e._v(" "),t("p",[e._v("Overall, Kubernetes helps organizations to build, deploy, and manage large-scale, complex applications more efficiently and effectively.")]),e._v(" "),t("h2",{attrs:{id:"kubernetes-main-components-architechture"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kubernetes-main-components-architechture"}},[e._v("#")]),e._v(" Kubernetes Main Components & Architechture:")]),e._v(" "),t("p",[e._v("Kubernetes is an open-source platform for automating deployment, scaling, and management of containerized applications. The following are the main components of a Kubernetes system:")]),e._v(" "),t("ol",[t("li",[e._v("Master node: The Master node is the brain of a Kubernetes cluster and it is responsible for the overall management of the cluster. It exposes the Kubernetes API, and it contains the following components:")])]),e._v(" "),t("ul",[t("li",[t("p",[e._v("kube-apiserver: Exposes the Kubernetes API.")])]),e._v(" "),t("li",[t("p",[e._v("etcd: Distributed key-value store for storing the configuration data.")])]),e._v(" "),t("li",[t("p",[e._v("kube-controller-manager: Handles the state of the cluster, such as replication controllers and endpoints.")])]),e._v(" "),t("li",[t("p",[e._v("kube-scheduler: Assigns work to nodes.")])])]),e._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[e._v("Worker node: Worker nodes are where containers are deployed and run. A worker node contains the following components:")])]),e._v(" "),t("ul",[t("li",[e._v("kubelet: Communicates with the Master node and makes sure that containers are running as expected.")]),e._v(" "),t("li",[e._v("kube-proxy: Acts as a network proxy and load balancer for service requests.")]),e._v(" "),t("li",[e._v("container run time: we can use any container run time environment like docker or containerd")])]),e._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[t("p",[e._v("Pods: Pods are the smallest and simplest unit in the Kubernetes object model, and they represent a single instance of a running process in your cluster. Pods contain one or more containers, and they provide shared network and storage resources for those containers.")])]),e._v(" "),t("li",[t("p",[e._v("Containers: The applications you want to run are packaged into containers, which are lightweight, stand-alone, and executable packages of software that include everything needed to run the application (code, runtime, system tools, libraries, etc.).")])]),e._v(" "),t("li",[t("p",[e._v("Volumes: Volumes are a way to persist data in your cluster, even if a pod is deleted or recreated. They provide a way to store data on disk or in the cloud, and mount that data into your pods.")])]),e._v(" "),t("li",[t("p",[e._v("Services: Services are used to expose your application to the network, allowing it to be accessible from outside the cluster. Services can load balance incoming traffic to multiple pods.")])]),e._v(" "),t("li",[t("p",[e._v("Replication Controller: Replication controllers are used to ensure that a specified number of replicas of a pod are running at all times. If a pod goes down, the replication controller will create a new replica to replace it.")])]),e._v(" "),t("li",[t("p",[e._v("Deployments: Deployments are higher-level objects that manage replicas and provide declarative updates for your applications. You define your desired state in a deployment, and the deployment controller changes the actual state to the desired state.")])]),e._v(" "),t("li",[t("p",[e._v("ConfigMaps and Secrets: ConfigMaps and Secrets are used to store configuration data and secrets, respectively, for your applications. They can be used to store database passwords, API keys, and other sensitive information.")])]),e._v(" "),t("li",[t("p",[e._v("Ingress: Kubernetes Ingress is a collection of routing rules that govern how external users access services running inside a Kubernetes cluster. It provides a way to expose HTTP and HTTPS routes from outside the cluster to services within the cluster.")])])]),e._v(" "),t("p",[e._v('An Ingress resource defines how requests to a certain path or host should be routed to a specific service within the cluster. For example, you can define a rule that routes requests to the host "www.example.com" to a service that serves a web application. You can also define multiple rules to route requests to different paths or hosts to different services.')]),e._v(" "),t("p",[e._v("Ingress is typically implemented by deploying an Ingress controller, which is a component that watches the API server for updates to the Ingress resource and implements the routing rules accordingly. The Ingress controller can be any web server that implements the Ingress specification, such as Nginx, Traefik, or Istio.")]),e._v(" "),t("p",[e._v("Ingress provides an easy and efficient way to expose your applications to external users and manage the incoming traffic to your services. It can be used to enforce security policies, such as SSL/TLS encryption, basic authentication, and rate limiting, and to handle tasks such as request redirection and URL rewriting.")]),e._v(" "),t("p",[e._v("These are the main components of a Kubernetes system. Understanding these components is crucial for effectively managing and deploying applications on a Kubernetes cluster.")]),e._v(" "),t("h2",{attrs:{id:"minikube-setup-on-local-machine"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#minikube-setup-on-local-machine"}},[e._v("#")]),e._v(" Minikube Setup on Local machine")]),e._v(" "),t("p",[e._v("Minikube is a tool that allows you to run a single-node Kubernetes cluster on your local machine. You can also set it up on a remote server. Here's how you can set up Minikube on a server:")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Install virtualization software: Minikube requires a hypervisor to manage virtual machines. You can use VirtualBox, KVM, or Hyper-V as the hypervisor.")])]),e._v(" "),t("li",[t("p",[e._v("Install Minikube: You can download Minikube binary for your operating system from the official Minikube website and install it. You can also install Minikube using a package manager like apt or yum.")])]),e._v(" "),t("li",[t("p",[e._v("Start Minikube: To start Minikube, you need to run the following command:")])])]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("minikube start "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--driver")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("driver_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])]),t("ol",{attrs:{start:"4"}},[t("li",[e._v("Verify the installation: To verify that Minikube is running, you can use the following command:")])]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("minikube status\n")])])]),t("p",[e._v("This will give you the status of your Minikube cluster, including the Kubernetes version, the URL of the dashboard, and the state of the cluster.")]),e._v(" "),t("ol",{attrs:{start:"5"}},[t("li",[e._v("Access the dashboard: To access the Minikube dashboard, you can use the following command:")])]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("minikube dashboard\n")])])]),t("h2",{attrs:{id:"how-to-setup-a-simple-3-three-node-kubernetes-cluster-on-ubuntu-servers-on-top-of-proxmox-server"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#how-to-setup-a-simple-3-three-node-kubernetes-cluster-on-ubuntu-servers-on-top-of-proxmox-server"}},[e._v("#")]),e._v(" How to setup a simple 3 (Three) node kubernetes cluster on ubuntu servers on top of proxmox server.")]),e._v(" "),t("h3",{attrs:{id:"prerequisites"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[e._v("#")]),e._v(" Prerequisites")]),e._v(" "),t("p",[e._v("To follow along with this tutorial, you’ll need:")]),e._v(" "),t("p",[e._v("At least three Ubuntu Server 22.04 instances (one for the controller, two for worker node)\nA static IP address or DHCP reservation on those instances, so their IP addresses cannot change\nThe controller node should have at least 2GB of RAM and 2 cores\nThe node instances can have a single gigabyte of RAM and a single CPU core (or more if you prefer)\nNote: This tutorial utilizes Ubuntu Server 22.04. If you choose to use a different distribution or a different\nversion of Ubuntu, these commands may not work.")]),e._v(" "),t("h3",{attrs:{id:"setting-up-the-cluster"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-the-cluster"}},[e._v("#")]),e._v(" Setting up the cluster")]),e._v(" "),t("p",[e._v("The following commands are to be run on the controller/master node (unless otherwise stated).")]),e._v(" "),t("h4",{attrs:{id:"setting-up-a-static-ip"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-a-static-ip"}},[e._v("#")]),e._v(" Setting up a static IP")]),e._v(" "),t("p",[e._v("Note, a static lease is preferred, but you can use the following Netplan config example to serve as a basis of\nyours if you need to set up a static IP.")]),e._v(" "),t("div",{staticClass:"language-yml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("network")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("ethernets")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("enp0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("dhcp4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" no\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("addresses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("192.168.10.10/24"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("nameservers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("addresses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("8.8.8.8"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("routes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("to")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" default\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("via")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" 192.168.10.1\n")])])]),t("h4",{attrs:{id:"installing-containerd"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#installing-containerd"}},[e._v("#")]),e._v(" Installing containerd")]),e._v(" "),t("p",[e._v("This Kubernetes cluster will utilize the containerd runtime. To set that up, we’ll first need to install the\nrequired package:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt-get")]),e._v(" update\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt-get")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n")])])]),t("p",[e._v("Create the initial configuration:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("mkdir")]),e._v(" /etc/containerd\ncontainerd config default "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("tee")]),e._v(" /etc/containerd/config.toml\n")])])]),t("p",[e._v("For this cluster to work properly, we’ll need to enable SystemdCgroup within the configuration. To do that, we’ll\nneed to edit the config we’ve just created:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("nano")]),e._v(" /etc/containerd/config.toml\n")])])]),t("p",[e._v("Within that file, find the following line of text:")]),e._v(" "),t("p",[t("em",[e._v('[plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc.options]')])]),e._v(" "),t("p",[e._v("Underneath that, find the SystemdCgroup option and change it to true, which should look like this:")]),e._v(" "),t("p",[t("strong",[e._v("SystemdCgroup = true")])]),e._v(" "),t("p",[e._v("Disable swap\nKubernetes requires swap to be disabled. To turn off swap, we can run the following command:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" swapoff "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-a")]),e._v("\n")])])]),t("p",[e._v("Next, edit the /etc/fstab file and comment out the line that corresponds to swap (if present). This will help\nensure swap doesn’t end up getting turned back on after reboot.")]),e._v(" "),t("p",[e._v("Enable bridging\nTo enable bridging, we only need to edit one config file:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("nano")]),e._v(" /etc/sysctl.conf\nWithin that file, "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("look")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" the following line:\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#net.ipv4.ip_forward=1")]),e._v("\nUncomment that line by removing the "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# symbol in front of it, which should make it look like this:")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("net.ipv4.ip_forward")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("\nEnable br_netfilter\n")])])]),t("p",[e._v("The next step is to enable br_netfilter by editing yet another config file:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("nano")]),e._v(" /etc/modules-load.d/k8s.conf\nAdd the following to that "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("file")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("the "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("file")]),e._v(" should actually be empty at first"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(":\n\nbr_netfilter\n")])])]),t("p",[e._v("Reboot your servers\nReboot each of your instances to ensure all of our changes so far are in place:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("reboot")]),e._v("\n")])])]),t("h3",{attrs:{id:"installing-kubernetes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#installing-kubernetes"}},[e._v("#")]),e._v(" Installing Kubernetes")]),e._v(" "),t("p",[e._v("The next step is to install the packages that are required for Kubernetes. First, we’ll add the required GPG key:")]),e._v(" "),t("p",[e._v("Update the apt package index and install packages needed to use the Kubernetes apt repository:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt-get")]),e._v(" update\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt-get")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-y")]),e._v(" apt-transport-https ca-certificates "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v("\n")])])]),t("p",[e._v("Download the Google Cloud public signing key:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-fsSLo")]),e._v(" /etc/apt/keyrings/kubernetes-archive-keyring.gpg https://packages.cloud.google.com/apt/doc/apt-key.gpg\n")])])]),t("p",[e._v("Add the Kubernetes apt repository:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"deb [signed-by=/etc/apt/keyrings/kubernetes-archive-keyring.gpg] https://apt.kubernetes.io/ kubernetes-xenial main"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("tee")]),e._v(" /etc/apt/sources.list.d/kubernetes.list\n")])])]),t("p",[e._v("Update apt package index, install kubelet, kubeadm and kubectl, and pin their version:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt-get")]),e._v(" update\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt-get")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-y")]),e._v(" kubelet kubeadm kubectl kubernetes-cni\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" apt-mark hold kubelet kubeadm kubectl\n")])])]),t("p",[t("strong",[e._v("Controller node only:")]),e._v("\nInitialize our Kubernetes cluster\nSo long as you have everything complete so far, you can initialize the Kubernetes cluster now. Be sure to customize the first IP address shown here (not the second) and also change the name to match the name of your\ncontroller.")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" kubeadm init --control-plane-endpoint"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("172.16")]),e._v(".250.216 --node-name\ncontroller --pod-network-cidr"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.244")]),e._v(".0.0/16\n")])])]),t("p",[e._v("After the initialization finishes, you should see at least four commands printed within the output.")]),e._v(" "),t("p",[e._v("Setting up our user account to manage the cluster\nThree commands will be shown in the output from the previous command, and these commands will give our user\naccount access to manage our cluster. Here are those related commands to save you from having to search the output\nfor them:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("mkdir")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-p")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("$HOME")]),e._v("/.kube\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("cp")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-i")]),e._v(" /etc/kubernetes/admin.conf "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("$HOME")]),e._v("/.kube/config\nsuod "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("chown")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("id")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-u")]),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("id")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-g")]),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v(" "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("$HOME")]),e._v("/.kube/config\n")])])]),t("p",[e._v("Those commands should allow you to manage the cluster, without needing to use the root account to do so.")]),e._v(" "),t("p",[e._v("Install an Overlay Network")]),e._v(" "),t("p",[e._v("The following command will install the Flannel overlay network (an overlay network is required for this to\nfunction).")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl apply "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-f")]),e._v(" https://raw.githubusercontent.com/flannel-io/flannel/master/\nDocumentation/kube-flannel.yml\n")])])]),t("p",[e._v("Adding Nodes\nThe join command, which you will receive from the output once you initialize the cluster, can be ran on your node\ninstances now to get them joined to the cluster. The following command will help you monitor which nodes have been\nadded to the controller (it can take several minutes for them to appear):")]),e._v(" "),t("p",[e._v("If for some reason the join command has expired, the following command will provide you with a new one:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl get nodes\nkubeadm token create --print-join-command\n")])])]),t("p",[e._v("Deploying a container within our cluster\nCreate the file pod.yml with the following contents:")]),e._v(" "),t("div",{staticClass:"language-yml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" Pod\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("example\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("labels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("app")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" nginx\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("containers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" nginx\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" linuxserver/nginx\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("containerPort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("80")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"nginx-http"')]),e._v("\n")])])]),t("p",[e._v("Apply the file with the following command:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl apply "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-f")]),e._v(" pod.yml\n")])])]),t("p",[e._v("You can check the status of this deployment with the following command:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl get pods\n")])])]),t("p",[e._v("Creating a NodePort Service\nSetting up a NodePort service is one of the methods we can use to be able to access the container from outside the\npod network. To set this up, first create the following file as service-nodeport.yml:")]),e._v(" "),t("div",{staticClass:"language-yml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" Service\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("example\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" NodePort\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" http\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("80")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("nodePort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("30080")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("targetPort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("http\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("selector")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("app")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" nginx\n")])])]),t("p",[e._v("You can apply that file with the following command:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl apply "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-f")]),e._v(" service-nodeport.yml\n")])])]),t("p",[e._v("To check the status of the service deployment, you can use the following command:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl get services\n")])])]),t("p",[e._v("And now, you have your very own Kubernetes cluster, congratulations!")]),e._v(" "),t("h2",{attrs:{id:"install-kubernetes-master-node-on-rocky-linux-9"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-kubernetes-master-node-on-rocky-linux-9"}},[e._v("#")]),e._v(" Install Kubernetes Master Node on Rocky Linux 9.")]),e._v(" "),t("p",[e._v("In this configuration guide, you will learn how to install Kubernetes Master Node on Rocky Linux 9 or other RPM based Linux distros.\nRef: "),t("a",{attrs:{href:"https://youtu.be/WaAEcyu28BI",target:"_blank",rel:"noopener noreferrer"}},[e._v("YouTube Video Link"),t("OutboundLink")],1)]),e._v(" "),t("p",[e._v("Set Hostname and Name Resolution:\nBy using a ssh client, connect with your Linux server as root user.")]),e._v(" "),t("p",[e._v("Set a proper FQDN (Fully Qualified Domain Name) for your Kubernetes server. Also use the Local DNS resolver (/etc/hosts) for name resolution of your hostname.")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("hostnamectl set-hostname k8s-master-node\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("192.168")]),e._v(".30.110 k8s-master-node "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">>")]),e._v(" /etc/hosts\n")])])]),t("h4",{attrs:{id:"updating-rocky-linux-server"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#updating-rocky-linux-server"}},[e._v("#")]),e._v(" Updating Rocky Linux Server:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("dnf makecache "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--refresh")]),e._v("\ndnf update "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-y")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" /etc/rocky-release\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("uname")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-r")]),e._v("\n")])])]),t("h4",{attrs:{id:"switch-selinux-to-permissive-mode"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#switch-selinux-to-permissive-mode"}},[e._v("#")]),e._v(" Switch SELinux to Permissive Mode:")]),e._v(" "),t("p",[e._v("Kubernetes doesn't provide a SELinux policy, therefore you can either switch SELinux target to Permissive mode or manually set the File Context of various Kubernetes files and directories.")]),e._v(" "),t("p",[e._v("For the scope of this article, we recommend that you should set permissive target for SELinux. However, if you are configuring a Kubernetes cluster for production then you should identify the files and set the File Context for them, or you can even create your own SELinux policy.")]),e._v(" "),t("p",[e._v("Execute following commands at Linux bash to set SELinux permissive mode.")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("setenforce "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sed")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-i")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'s/^SELINUX=enforcing$/SELINUX=permissive/'")]),e._v(" /etc/selinux/config\n")])])]),t("h4",{attrs:{id:"loading-k8s-required-kernel-modules"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#loading-k8s-required-kernel-modules"}},[e._v("#")]),e._v(" Loading K8s required Kernel Modules:")]),e._v(" "),t("p",[e._v('Kubernetes requires "overlay" and "br_netfilter" Kernel modules. Therefore, you can use following group of commands to permanently enable them.')]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("modprobe overlay\nmodprobe br_netfilter\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" /etc/modules-load.d/k8s.conf "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("EOF\noverlay\nbr_netfilter\nEOF")]),e._v("\n")])])]),t("p",[e._v("Set following Kernel parameter as required by Kubernetes software.")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" /etc/sysctl.d/k8s.conf "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("EOF\nnet.ipv4.ip_forward = 1\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.bridge.bridge-nf-call-iptables = 1\nEOF")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sysctl")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--system")]),e._v("\n\n")])])]),t("h4",{attrs:{id:"disable-swap-in-linux"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#disable-swap-in-linux"}},[e._v("#")]),e._v(" Disable Swap in Linux:")]),e._v(" "),t("p",[e._v("To disable Swap for your current session you can use swapoff command. However, for permanently disable the Swap storage you have to comment (#) the respective directive in /etc/fstab file.")]),e._v(" "),t("p",[e._v("Execute following commands to do the same.")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("swapoff "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-a")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sed")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-e")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'/swap/s/^/#/g'")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-i")]),e._v(" /etc/fstab\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("free")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-m")]),e._v("\n")])])]),t("h4",{attrs:{id:"install-docker-on-rockylinux-redhat"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-docker-on-rockylinux-redhat"}},[e._v("#")]),e._v(" Install Docker on rockylinux/redhat:")]),e._v(" "),t("p",[e._v("Referance link is: "),t("a",{attrs:{href:"https://docs.rockylinux.org/gemstones/docker/#add-the-docker-repository",target:"_blank",rel:"noopener noreferrer"}},[e._v("Rocky Linux Official Docs"),t("OutboundLink")],1)]),e._v(" "),t("h4",{attrs:{id:"add-the-docker-repository"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#add-the-docker-repository"}},[e._v("#")]),e._v(" Add the docker repository")]),e._v(" "),t("p",[e._v("Use the "),t("code",[e._v("dnf")]),e._v(" utility to add the docker repository to your Rocky Linux server. Type:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" dnf config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n")])])]),t("h4",{attrs:{id:"install-the-needed-packages"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-the-needed-packages"}},[e._v("#")]),e._v(" Install the needed packages")]),e._v(" "),t("p",[e._v("Install the latest version of Docker Engine, containerd, and Docker Compose, by running:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" dnf update\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" dnf makecache\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" dnf "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-y")]),e._v(" docker-ce docker-ce-cli containerd.io docker-compose-plugin\n")])])]),t("h4",{attrs:{id:"start-and-enable-the-systemd-docker-service-dockerd"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#start-and-enable-the-systemd-docker-service-dockerd"}},[e._v("#")]),e._v(" Start and enable the systemd docker service (dockerd)")]),e._v(" "),t("p",[e._v("Use the "),t("code",[e._v("systemctl")]),e._v(" utility to configure the dockerd daemon to automatically startup with the next system reboot and simultaneously start it for the current session. Type:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" systemctl "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--now")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("enable")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v("\n")])])]),t("h4",{attrs:{id:"notes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#notes"}},[e._v("#")]),e._v(" Notes")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("docker-ce               "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" This package provides the underlying technology "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" building and running "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" containers "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("dockerd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\ndocker-ce-cli           "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" Provides the "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("command")]),e._v(" line interface "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("CLI"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" client "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" tool "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\ncontainerd.io           "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" Provides the container runtime "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("runc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\ndocker-compose-plugin   "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" A plugin that provides the "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'docker compose'")]),e._v(" subcommand\n\n")])])]),t("p",[t("strong",[e._v("some extrea packeges:")])]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" dnf "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" epel-release "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-y")]),e._v("\n")])])]),t("p",[e._v("After installation, backup the original containerd configuration file and generate a new file as follows.")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("mv")]),e._v(" /etc/containerd/config.toml /etc/containerd/config.toml.orig\ncontainerd config default "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" /etc/containerd/config.toml\n")])])]),t("p",[e._v("Edit Containerd configuration file by using nano text editor.")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("nano")]),e._v(" /etc/containerd/config.toml\n")])])]),t("p",[e._v("Locate and set SystemdCgroup parameter in this file, to enable the systemd cgroup driver for Containerd runtime.")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("plugins."),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"io.containerd.grpc.v1.cri"')]),e._v(".containerd.runtimes.runc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("plugins."),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"io.containerd.grpc.v1.cri"')]),e._v(".containerd.runtimes.runc.options"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n    SystemdCgroup "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),e._v("\n")])])]),t("p",[e._v("Enable and start Containerd service.")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("systemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("enable")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--now")]),e._v(" containerd.service\nsystemctl status containerd.service\n")])])]),t("h4",{attrs:{id:"configure-linux-firewall"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#configure-linux-firewall"}},[e._v("#")]),e._v(" Configure Linux Firewall:")]),e._v(" "),t("p",[e._v("Therefore, you need to allow these service ports in Linux firewall.")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("firewall-cmd "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--permanent")]),e._v(" --add-port"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("6443,2379")]),e._v(",2380,9090,10250,10251,10252"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("/tcp\nfirewall-cmd "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--reload")]),e._v("\n")])])]),t("h4",{attrs:{id:"installing-kubernetes-software"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#installing-kubernetes-software"}},[e._v("#")]),e._v(" Installing Kubernetes Software:")]),e._v(" "),t("p",[e._v("To install Orchestration software, you have to add the Kubernetes Official Yum Repository.")]),e._v(" "),t("p",[e._v("The following command will add the Kubernetes repository in your Linux server.")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" /etc/yum.repos.d/k8s.repo "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("EOF\n[kubernetes]\nname=Kubernetes\nbaseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-\\"),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$basearch")]),e._v("\nenabled=1\ngpgcheck=1\ngpgkey=https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg\nexclude=kubelet kubeadm kubectl\nEOF")]),e._v("\nBuild the yum cache "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" Kubernetes yum repository.\ndnf makecache\n")])])]),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("dnf update "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-y")]),e._v("\ndnf "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-y")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("kubelet,kubeadm,kubectl"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--disableexcludes")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("kubernetes\nsystemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("enable")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--now")]),e._v(" kubelet.service\nsystemctl status kubelet\n")])])]),t("h4",{attrs:{id:"enable-bash-completion-for-kubernetes-commands"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#enable-bash-completion-for-kubernetes-commands"}},[e._v("#")]),e._v(" Enable Bash Completion for Kubernetes Commands:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("source")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("kubectl completion "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("bash")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\nkubectl completion "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("bash")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" /etc/bash_completion.d/kubectl\n")])])]),t("h4",{attrs:{id:"installing-flannel-cni-plugin"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#installing-flannel-cni-plugin"}},[e._v("#")]),e._v(" Installing Flannel CNI Plugin:")]),e._v(" "),t("p",[e._v("Kubernetes supports various CNI (Container Network Interface) plugins, such as AWS VPC, Azure CNI, Cilium, Calico, Flannel, and many more.")]),e._v(" "),t("p",[e._v("In this configuration guide, we are using Flannel CNI plugin. Ensure that this plugin must be installed on each Kubernetes node.")]),e._v(" "),t("p",[e._v("Create a directory and download flanneld file therein.")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("mkdir")]),e._v(" /opt/bin\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-fsSLo")]),e._v(" /opt/bin/flanneld https://github.com/flannel-io/flannel/releases/download/v0.20.1/flannel-v0.20.1-linux-amd64.tar.gz\n")])])]),t("p",[e._v("Grant execution permissions to flanneld file to make it an executable.")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("chmod")]),e._v(" +x /opt/bin/flanneld\n")])])]),t("h4",{attrs:{id:"initializing-kubernetes-control-plane"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#initializing-kubernetes-control-plane"}},[e._v("#")]),e._v(" Initializing Kubernetes Control Plane:")]),e._v(" "),t("p",[e._v("Execute the following command to download container images, that are required to create Kubernetes Cluster.")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubeadm config images pull\nkubeadm init\n")])])]),t("p",[e._v("Note down the command to add Kubernetes Worker node for later use.")]),e._v(" "),t("p",[e._v("Execute following command to set KUBECONFIG variable for all sessions.")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"export KUBECONFIG=/etc/kubernetes/admin.conf"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">>")]),e._v(" /etc/profile.d/k8s.sh\n")])])]),t("p",[e._v("Execute following commands as a user, that is being used to manage your Kubernetes cluster.")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("mkdir")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-p")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("$HOME")]),e._v("/.kube\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("cp")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-i")]),e._v(" /etc/kubernetes/admin.conf "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("$HOME")]),e._v("/.kube/config\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("chown")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("id")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-u")]),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("id")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-g")]),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v(" "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("$HOME")]),e._v("/.kube/config\n")])])]),t("p",[e._v("Execute kubectl commands to check the status of your Kubernetes cluster.")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl get nodes\nkubectl cluster-info\n")])])]),t("p",[e._v('After Kubernetes Control Plane is started, run the following command to install the Flannel Pod network plugin. This command will automatically run the "flanneld" binary file and start some flannel pods.')]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl apply "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-f")]),e._v(" https://raw.githubusercontent.com/flannel-io/flannel/master/Documentation/kube-flannel.yml\n")])])]),t("p",[e._v("Check the list of running pods on your Kubernetes cluster.")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl get pods --all-namespaces\n")])])]),t("p",[t("strong",[e._v("Congratulations! Your kubernetes master node has been installed successfully.")])]),e._v(" "),t("h2",{attrs:{id:"kubectl-commands"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kubectl-commands"}},[e._v("#")]),e._v(" Kubectl commands")]),e._v(" "),t("p",[e._v("Here are some of the most commonly used Kubernetes commands written in raw markdown code:")]),e._v(" "),t("h3",{attrs:{id:"basic-commands"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#basic-commands"}},[e._v("#")]),e._v(" Basic Commands")]),e._v(" "),t("p",[t("code",[e._v("kubectl create")]),e._v(" - Create a resource from a file or stdin\n"),t("code",[e._v("kubectl apply")]),e._v(" - Apply a configuration to a resource by filename or stdin\n"),t("code",[e._v("kubectl get")]),e._v(" - Display one or many resources\n"),t("code",[e._v("kubectl describe")]),e._v(" - Show details of a specific resource or group of resources\n"),t("code",[e._v("kubectl delete")]),e._v(" - Delete resources by filenames, stdin, resources and names, or by resources and label selector")]),e._v(" "),t("h3",{attrs:{id:"pod-management"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pod-management"}},[e._v("#")]),e._v(" Pod Management")]),e._v(" "),t("p",[t("code",[e._v("kubectl run")]),e._v(" - Create a new deployment or job with a pod template\n"),t("code",[e._v("kubectl expose")]),e._v(" - Expose a deployment, replica set, or replication controller as a service\n"),t("code",[e._v("kubectl port-forward")]),e._v(" - Forward one or more local ports to a pod\n"),t("code",[e._v("kubectl logs")]),e._v(" - Print the logs for a container in a pod")]),e._v(" "),t("h3",{attrs:{id:"deployment-management"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#deployment-management"}},[e._v("#")]),e._v(" Deployment Management")]),e._v(" "),t("p",[t("code",[e._v("kubectl rollout")]),e._v(" - Manage the rollout of a resource\n"),t("code",[e._v("kubectl scale")]),e._v(" - Set a new size for a deployment, replica set, or replication controller\n"),t("code",[e._v("kubectl autoscale")]),e._v(" - Auto-scale a deployment, replica set, or replication controller based on resource usage\n"),t("code",[e._v("kubectl update")]),e._v(" - Update a deployment, replica set, or replication controller to a new version")]),e._v(" "),t("h3",{attrs:{id:"cluster-management"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cluster-management"}},[e._v("#")]),e._v(" Cluster Management")]),e._v(" "),t("p",[t("code",[e._v("kubectl config")]),e._v(" - Modify kubeconfig files\n"),t("code",[e._v("kubectl cluster-info")]),e._v(" - Display cluster information\n"),t("code",[e._v("kubectl top")]),e._v(" - Display Resource (CPU/Memory/Storage) usage\n"),t("code",[e._v("kubectl version")]),e._v(" - Display the Kubernetes version running on the client and server")]),e._v(" "),t("p",[e._v("These are just a few examples of commonly used Kubernetes commands. For a full list of available commands, you can refer to the official Kubernetes documentation.")])])}),[],!1,null,null,null);t.default=n.exports}}]);